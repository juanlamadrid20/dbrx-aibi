{
  "datasets": [
    {
      "name": "303a6758",
      "displayName": "Count of Tables",
      "queryLines": [
        "SELECT COUNT(*) FROM system.information_schema.tables;"
      ]
    },
    {
      "name": "f5bf425c",
      "displayName": "Count of Volumes",
      "queryLines": [
        "SELECT COUNT(*) FROM system.information_schema.volumes;"
      ]
    },
    {
      "name": "5fdcd556",
      "displayName": "Count of Functions",
      "queryLines": [
        "SELECT COUNT(*) FROM system.information_schema.routines;"
      ]
    },
    {
      "name": "a92ace17",
      "displayName": "Count of Unused Tables",
      "queryLines": [
        "SELECT \n",
        "  COUNT(DISTINCT CONCAT(ist.table_catalog, '.', ist.table_schema, '.', ist.table_name)) AS full_name_count\n",
        "FROM \n",
        "  system.information_schema.tables ist\n",
        "  LEFT JOIN \n",
        "    (SELECT \n",
        "       tl.source_table_catalog,\n",
        "       tl.source_table_schema,\n",
        "       tl.source_table_name\n",
        "     FROM \n",
        "       system.access.table_lineage tl\n",
        "     WHERE \n",
        "       tl.event_time BETWEEN :date_range_start AND :date_range_end\n",
        "       AND tl.source_type IN ('TABLE', 'STREAMING_TABLE')\n",
        "    ) tl\n",
        "    ON \n",
        "      tl.source_table_catalog = ist.table_catalog \n",
        "      AND tl.source_table_schema = ist.table_schema \n",
        "      AND tl.source_table_name = ist.table_name\n",
        "WHERE\n",
        "  tl.source_table_catalog IS NULL;"
      ],
      "parameters": [
        {
          "displayName": "date_range_start",
          "keyword": "date_range_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-30d/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "date_range_end",
          "keyword": "date_range_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "55e66413",
      "displayName": "Count of Tables with Usage",
      "queryLines": [
        "SELECT \n",
        "  COUNT(DISTINCT CONCAT(source_table_catalog, '.', source_table_schema, '.', source_table_name)) AS distinct_tables\n",
        "FROM \n",
        "  system.access.table_lineage\n",
        "WHERE \n",
        "  event_time BETWEEN :date_range_start AND :date_range_end\n",
        "  AND source_table_full_name IS NOT NULL\n",
        "  AND source_type IN ('TABLE', 'STREAMING_TABLE');"
      ],
      "parameters": [
        {
          "displayName": "date_range_start",
          "keyword": "date_range_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-30d/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "date_range_end",
          "keyword": "date_range_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "90d7e6f1",
      "displayName": "Count of Unique Users with Table Read/Write Event",
      "queryLines": [
        "SELECT \n",
        "  COUNT(DISTINCT created_by) AS distinct_users\n",
        "\n",
        "FROM \n",
        "  system.access.table_lineage AS tl\n",
        "\n",
        "WHERE \n",
        "  event_time >= :date_range_start\n",
        "  AND event_time <= :date_range_end\n",
        "  AND (source_table_full_name IS NOT NULL);"
      ],
      "parameters": [
        {
          "displayName": "date_range_start",
          "keyword": "date_range_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-30d/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "date_range_end",
          "keyword": "date_range_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "628c2773",
      "displayName": "Count of Unsecured Tables",
      "queryLines": [
        "SELECT \n",
        "    COUNT(DISTINCT CONCAT(TABLE_CATALOG, '.', TABLE_SCHEMA, '.', TABLE_NAME)) AS full_name_count\n",
        "FROM \n",
        "    system.information_schema.table_privileges\n",
        "WHERE \n",
        "    grantee = 'account users' \n",
        "    AND privilege_type = 'SELECT';"
      ]
    },
    {
      "name": "1f951287",
      "displayName": "Count of Sensitive Tables",
      "queryLines": [
        "SELECT COUNT(DISTINCT CONCAT(table_catalog, '.', table_schema, '.', table_name)) AS distinct_table_count\n",
        "FROM (\n",
        "    SELECT \n",
        "        table_catalog, table_schema, table_name\n",
        "    FROM \n",
        "        system.information_schema.column_masks\n",
        "\n",
        "    UNION\n",
        "\n",
        "    SELECT \n",
        "        table_catalog, table_schema, table_name\n",
        "    FROM \n",
        "        system.information_schema.row_filters\n",
        ") AS combined;\n"
      ]
    },
    {
      "name": "913b3827",
      "displayName": "Pie Chart of Tagged vs. Untagged Tables",
      "queryLines": [
        "WITH tagged_count AS (\n",
        "    SELECT COUNT(*) AS count FROM system.information_schema.table_tags\n",
        ")\n",
        "SELECT 'Tagged' AS label, count \n",
        "FROM tagged_count\n",
        "UNION ALL\n",
        "SELECT 'Untagged' AS label, \n",
        "       (SELECT COUNT(*) FROM system.information_schema.tables) - count \n",
        "FROM tagged_count;"
      ]
    },
    {
      "name": "788914b8",
      "displayName": "Bar Chart of Popular Tags",
      "queryLines": [
        "SELECT \n",
        "  tag_name,\n",
        "  COUNT(*) AS usage_count\n",
        "FROM \n",
        "  system.information_schema.table_tags\n",
        "WHERE \n",
        "  tag_name IS NOT NULL\n",
        "GROUP BY \n",
        "  tag_name\n",
        "ORDER BY \n",
        "  usage_count DESC\n",
        "LIMIT 10;"
      ]
    },
    {
      "name": "8d97349c",
      "displayName": "Usage Over Last Year",
      "queryLines": [
        "SELECT \n",
        "    DATE_TRUNC('month', event_time) AS usage_date,\n",
        "    COUNT(*) AS usage_count\n",
        "FROM \n",
        "    system.access.table_lineage\n",
        "WHERE \n",
        "    (event_time >= :date_range_start AND event_time <= :date_range_end )\n",
        "GROUP BY \n",
        "    usage_date\n",
        "ORDER BY\n",
        "    usage_date;"
      ],
      "parameters": [
        {
          "displayName": "date_range_start",
          "keyword": "date_range_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-12M/M"
                }
              ]
            }
          }
        },
        {
          "displayName": "date_range_end",
          "keyword": "date_range_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "763a2da9",
      "displayName": "Most Popular Tables with Staleness",
      "queryLines": [
        "WITH TableReads AS (\n",
        "    SELECT\n",
        "        CONCAT(source_table_catalog, '.', source_table_schema, '.', source_table_name) AS table_full_name,\n",
        "        COUNT(*) AS read_count\n",
        "    FROM\n",
        "        system.access.table_lineage\n",
        "    WHERE\n",
        "        source_table_catalog IS NOT NULL\n",
        "        AND :date_range_start <= event_date AND event_date <= :date_range_end\n",
        "    GROUP BY\n",
        "        table_full_name\n",
        "),\n",
        "LatestTargetDate AS (\n",
        "    SELECT\n",
        "        CONCAT(target_table_catalog, '.', target_table_schema, '.', target_table_name) AS table_full_name,\n",
        "        MAX(event_date) AS latest_target_date\n",
        "    FROM\n",
        "        system.access.table_lineage\n",
        "    WHERE\n",
        "        target_table_catalog IS NOT NULL\n",
        "    GROUP BY\n",
        "        table_full_name\n",
        ")\n",
        "SELECT\n",
        "    tr.table_full_name,\n",
        "    tr.read_count,\n",
        "    COALESCE(ltd.latest_target_date, 'N/A') AS latest_target_date\n",
        "FROM\n",
        "    TableReads tr\n",
        "LEFT JOIN\n",
        "    LatestTargetDate ltd ON tr.table_full_name = ltd.table_full_name\n",
        "ORDER BY\n",
        "    tr.read_count DESC\n",
        "LIMIT 10;\n"
      ],
      "parameters": [
        {
          "displayName": "date_range_start",
          "keyword": "date_range_start",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now-30d/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "date_range_end",
          "keyword": "date_range_end",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "now/s"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "pages": [
    {
      "name": "e9e15078",
      "displayName": "New Page",
      "layout": [
        {
          "widget": {
            "name": "ec3a56bc",
            "multilineTextboxSpec": {
              "lines": [
                "# Unity Catalog Overview"
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "d682affb",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "303a6758",
                  "fields": [
                    {
                      "name": "count(1)",
                      "expression": "`count(1)`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count(1)",
                  "style": {
                    "rules": [
                      {
                        "condition": {
                          "operator": "=",
                          "operand": {
                            "type": "data-value",
                            "value": "0"
                          }
                        },
                        "color": "#888888"
                      }
                    ]
                  },
                  "displayName": "count(1)"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": false,
                "title": "Total Tables"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "f0321af0",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "f5bf425c",
                  "fields": [
                    {
                      "name": "count(1)",
                      "expression": "`count(1)`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count(1)",
                  "style": {
                    "rules": [
                      {
                        "condition": {
                          "operator": "=",
                          "operand": {
                            "type": "data-value",
                            "value": "0"
                          }
                        },
                        "color": "#888888"
                      }
                    ]
                  },
                  "displayName": "count(1)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Volumes",
                "contentAlignment": "center"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "ee5b3bb1",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "5fdcd556",
                  "fields": [
                    {
                      "name": "count(1)",
                      "expression": "`count(1)`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count(1)",
                  "style": {
                    "rules": [
                      {
                        "condition": {
                          "operator": "=",
                          "operand": {
                            "type": "data-value",
                            "value": "0"
                          }
                        },
                        "color": "#888888"
                      }
                    ]
                  },
                  "displayName": "count(1)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Functions"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "33abd742",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a92ace17",
                  "fields": [
                    {
                      "name": "full_name_count",
                      "expression": "`full_name_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "full_name_count",
                  "displayName": "full_name_count"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "description": "See the count of tables with no reads",
                "title": "Unused Tables (Last 30 Days)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "bb0b2fd5",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "55e66413",
                  "fields": [
                    {
                      "name": "distinct_tables",
                      "expression": "`distinct_tables`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "distinct_tables",
                  "style": {
                    "rules": [
                      {
                        "condition": {
                          "operator": "=",
                          "operand": {
                            "type": "data-value",
                            "value": "0"
                          }
                        },
                        "color": "#888888"
                      }
                    ]
                  },
                  "displayName": "distinct_tables"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Tables (Last 30 days)",
                "showDescription": true,
                "description": "See the count of tables with reads"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 12,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "7414554c",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "90d7e6f1",
                  "fields": [
                    {
                      "name": "distinct_users",
                      "expression": "`distinct_users`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "distinct_users",
                  "style": {
                    "rules": [
                      {
                        "condition": {
                          "operator": "=",
                          "operand": {
                            "type": "data-value",
                            "value": "0"
                          }
                        },
                        "color": "#000000"
                      }
                    ]
                  },
                  "displayName": "distinct_users"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Users (Last 30 Days)",
                "showDescription": true,
                "description": "See the count of users who read from tables"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 12,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "bdaa8aa0",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "628c2773",
                  "fields": [
                    {
                      "name": "full_name_count",
                      "expression": "`full_name_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "full_name_count",
                  "displayName": "full_name_count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Ungoverned Tables",
                "showDescription": true,
                "description": "See the count of tables to which all users have read access"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 22,
            "width": 3,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "e60dfd50",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "1f951287",
                  "fields": [
                    {
                      "name": "distinct_table_count",
                      "expression": "`distinct_table_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "distinct_table_count",
                  "displayName": "distinct_table_count"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Sensitive Tables",
                "showDescription": true,
                "description": "See the count of tables with either row filters or column masks"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 22,
            "width": 3,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "75d01e2b",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "913b3827",
                  "fields": [
                    {
                      "name": "sum(count)",
                      "expression": "SUM(`count`)"
                    },
                    {
                      "name": "label",
                      "expression": "`label`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(count)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": " "
                },
                "color": {
                  "fieldName": "label",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "Untagged",
                        "color": "#919191"
                      },
                      {
                        "value": "Tagged",
                        "color": "#00A972"
                      }
                    ]
                  },
                  "displayName": "Legend"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Table Tag Usage",
                "showDescription": false,
                "description": "See the breakdown of tagged and untagged tables"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 25,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "ff45bac8",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "788914b8",
                  "fields": [
                    {
                      "name": "sum(usage_count)",
                      "expression": "SUM(`usage_count`)"
                    },
                    {
                      "name": "tag_name",
                      "expression": "`tag_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "sum(usage_count)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Usage Count"
                },
                "y": {
                  "fieldName": "tag_name",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "x-reversed"
                    }
                  },
                  "displayName": "Tag Name"
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Most Popular Table Tags",
                "showDescription": false,
                "description": ""
              },
              "mark": {
                "colors": [
                  "#AB4057",
                  "#FFAB00",
                  "#00A972",
                  "#FF3621",
                  "#8BCAE7",
                  "#AB4057",
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ]
              }
            }
          },
          "position": {
            "x": 2,
            "y": 25,
            "width": 4,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "4a969668",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "763a2da9",
                  "fields": [
                    {
                      "name": "sum(read_count)",
                      "expression": "SUM(`read_count`)"
                    },
                    {
                      "name": "table_full_name",
                      "expression": "`table_full_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "sum(read_count)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Usage Count"
                },
                "y": {
                  "fieldName": "table_full_name",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "x-reversed"
                    }
                  },
                  "displayName": "Table Name"
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Most Popular Tables",
                "showDescription": true,
                "description": "Identify the 10 most read from tables and see when they were last written to"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 15,
            "width": 6,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "f9046177",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "8d97349c",
                  "fields": [
                    {
                      "name": "monthly(usage_date)",
                      "expression": "DATE_TRUNC(\"MONTH\", `usage_date`)"
                    },
                    {
                      "name": "sum(usage_count)",
                      "expression": "SUM(`usage_count`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "monthly(usage_date)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "Period"
                },
                "y": {
                  "fieldName": "sum(usage_count)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Read Events"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Table Usage (Last 12 Months)",
                "description": "See read events for tables over time"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 6,
            "height": 7
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "uiSettings": {
    "theme": {
      "widgetHeaderAlignment": "ALIGNMENT_UNSPECIFIED"
    }
  }
}
